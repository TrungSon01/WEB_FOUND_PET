generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model ChatGroupMembers {
  id          Int         @id @default(autoincrement())
  user_id     Int?
  chatGroupId Int?
  deletedBy   Int         @default(0)
  isDeleted   Boolean     @default(false)
  deletedAt   DateTime?   @db.Timestamp(0)
  createdAt   DateTime    @default(now()) @db.Timestamp(0)
  updatedAt   DateTime    @default(now()) @db.Timestamp(0)
  Users       Users?      @relation(fields: [user_id], references: [user_id], onDelete: Cascade, map: "ChatGroupMembers_ibfk_1")
  ChatGroups  ChatGroups? @relation(fields: [chatGroupId], references: [id], onDelete: Cascade, map: "ChatGroupMembers_ibfk_2")

  @@index([chatGroupId], map: "chatGroupId")
  @@index([user_id], map: "user_id")
}

model ChatGroups {
  id               Int                @id @default(autoincrement())
  keyForChatOne    String?            @unique(map: "keyForChatOne") @db.VarChar(255)
  name             String?            @db.VarChar(255)
  type             ChatGroups_type?   @default(private)
  ownerId          Int?
  deletedBy        Int                @default(0)
  isDeleted        Boolean            @default(false)
  deletedAt        DateTime?          @db.Timestamp(0)
  createdAt        DateTime           @default(now()) @db.Timestamp(0)
  updatedAt        DateTime           @default(now()) @db.Timestamp(0)
  ChatGroupMembers ChatGroupMembers[]
  Users            Users?             @relation(fields: [ownerId], references: [user_id], map: "ChatGroups_ibfk_1")
  ChatMessages     ChatMessages[]

  @@index([ownerId], map: "ownerId")
}

model ChatMessages {
  id           Int        @id @default(autoincrement())
  chatGroupId  Int
  userIdSender Int
  messageText  String?    @db.Text
  deletedBy    Int        @default(0)
  isDeleted    Boolean    @default(false)
  deletedAt    DateTime?  @db.Timestamp(0)
  createdAt    DateTime   @default(now()) @db.Timestamp(0)
  updatedAt    DateTime   @default(now()) @db.Timestamp(0)
  ChatGroups   ChatGroups @relation(fields: [chatGroupId], references: [id], onDelete: Cascade, map: "ChatMessages_ibfk_1")
  Users        Users      @relation(fields: [userIdSender], references: [user_id], onDelete: Cascade, map: "ChatMessages_ibfk_2")

  @@index([chatGroupId], map: "chatGroupId")
  @@index([userIdSender], map: "userIdSender")
}

model Users {
  user_id          Int                @id @default(autoincrement())
  username         String             @db.VarChar(100)
  password         String?            @db.VarChar(255)
  email            String             @unique(map: "email") @db.VarChar(255)
  avatar           String?            @db.VarChar(255)
  phone            String?            @db.VarChar(20)
  role             Users_role?        @default(user)
  facebook_id      String?            @unique(map: "facebook_id") @db.VarChar(255)
  google_id        String?            @unique(map: "google_id") @db.VarChar(255)
  github_id        String?            @unique(map: "github_id") @db.VarChar(255)
  instagram_id     String?            @unique(map: "instagram_id") @db.VarChar(255)
  created_at       DateTime?          @default(now()) @db.Timestamp(0)
  updated_at       DateTime?          @default(now()) @db.Timestamp(0)
  ChatGroupMembers ChatGroupMembers[]
  ChatGroups       ChatGroups[]
  ChatMessages     ChatMessages[]
}

enum ChatGroups_type {
  private
  group
}

enum Users_role {
  user
  admin
}
